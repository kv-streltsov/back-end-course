  > Homework 9  Devices  DELETE -> "/security/devices/:deviceId": should return error if :id from uri param not found; status 404;



    Tested case params:
     endpoint: security/devices/602afe92-7d97-4395-b1b9-6cf98b351bbe,
     method: DELETE,
     headers: {"cookie":"refreshToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI3ZjI0YTUyOS1mNWY0LTQ4MmYtYWUyZS1jNTdmNjBhZjRhOTAiLCJkZXZpY2VJZCI6Ijk0M2JjNDZhLWUzNGEtNDhmYy1hYTViLTJiMzRkNTY2ZTliZCIsImlhdCI6MTY4NjcxNjIyMCwiZXhwIjoxNjg2NzE2MjQwfQ.y1cZ6uykLqxd-XchTRrI8jkll92lEu-BaHchMlaySb8;"},

    Expected status: 404

    Received status: 403

      49 |       }
      50 |
    > 51 |       expect(status).toBeWith4xxStatus(expectedStatusCode, {
         |                      ^
      52 |         headers,
      53 |         endpoint,
      54 |         method,

      at performEndpointErrorChecker (src/tests/jest/back/testHelpers/performCheckers.ts:51:22)
          at runMicrotasks (<anonymous>)
      at Object.<anonymous> (src/tests/jest/back/describes/devices/devices-describe.ts:206:7)

  > Homework 9  Devices  GET -> "/security/devices": should not change device id after call /auth/refresh-token. LastActiveDate should be changed; status 200; content: device list;

    expect(received).toHaveLength(expected)

    Expected length: 4
    Received length: 5
    Received array:  [{"deviceId": "943bc46a-e34a-48fc-aa5b-2b34d566e9bd", "ip": "3.69.49.83", "lastActiveDate": "2023-06-14T04:17:00.000Z", "title": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36"}, {"deviceId": "fd8f8a62-4fc9-40fb-907b-1fed9048eede", "ip": "3.69.49.83", "lastActiveDate": "2023-06-14T04:17:00.000Z", "title": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/103.0"}, {"deviceId": "303b2727-7e00-4f06-9ca4-463beca48656", "ip": "3.69.49.83", "lastActiveDate": "2023-06-14T04:17:01.000Z", "title": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"}, {"deviceId": "05cadc4c-017a-447a-976c-4fa88b5e40df", "ip": "3.69.49.83", "lastActiveDate": "2023-06-14T04:17:01.000Z", "title": "Mozilla/5.0 (Macintosh; Intel Mac OS X 12_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6 Safari/605.1.15"}, {"deviceId": "28350e65-53c8-45fa-ab9c-bf05f74b1de1", "ip": "3.69.49.83", "lastActiveDate": "2023-06-14T04:17:04.000Z", "title": "axios/1.3.4"}]

      323 |
      324 |       expect(devicesList).toBeStrictObjectsArray(securityDeviceSchema);
    > 325 |       expect(devicesList).toHaveLength(LOGGED_DEVICES_COUNT);
          |                           ^
      326 |       expect(devicesList).toStrictEqual(
      327 |         expect.arrayContaining([
      328 |           expect.objectContaining({ deviceId: chrome105DeviceIdBeforeRefresh }),

      at Object.<anonymous> (src/tests/jest/back/describes/devices/devices-describe.ts:325:27)
          at runMicrotasks (<anonymous>)

  > Homework 9  Devices  DELETE -> "/security/devices/deviceId": should delete device from device list by deviceId; status 204;  used additional methods: GET => /security/devices;



    Expected: success response

    Received: Request failed with status code 403

    Config:
     url: security/devices/fd8f8a62-4fc9-40fb-907b-1fed9048eede
     method: delete
     response status: 403
     request body: undefined
     response data: "Forbidden"

      22 |     };
      23 |
    > 24 |     expect(mappedError).printError(description);
         |                         ^
      25 |   }
      26 |
      27 |   throw new Error(error.message);

      at handleTestError (src/tests/jest/back/testHelpers/handleTestError.ts:24:25)
      at src/tests/jest/back/describes/devices/devices-describe.ts:363:41
          at runMicrotasks (<anonymous>)
      at Object.<anonymous> (src/tests/jest/back/describes/devices/devices-describe.ts:360:50)

  > Homework 9  Devices  DELETE -> "/security/devices": should delete all other devices from device list; status 204;  used additional methods: GET => /security/devices;



    Expected: success response

    Received: Request failed with status code 401

    Config:
     url: security/devices
     method: get
     response status: 401
     request body: undefined
     response data: "Unauthorized"

      22 |     };
      23 |
    > 24 |     expect(mappedError).printError(description);
         |                         ^
      25 |   }
      26 |
      27 |   throw new Error(error.message);

      at handleTestError (src/tests/jest/back/testHelpers/handleTestError.ts:24:25)
      at src/tests/jest/back/describes/devices/devices-describe.ts:442:35
          at runMicrotasks (<anonymous>)
      at Object.<anonymous> (src/tests/jest/back/describes/devices/devices-describe.ts:441:48)
